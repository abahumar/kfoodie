---
import { getCollection } from 'astro:content';
import BlogLayout from '../../layouts/BlogLayout.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map(post => ({
		params: { slug: post.slug },
		props: { post },
	}));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<BlogLayout title={post.data.title} description={post.data.description}>
	<article class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
		<!-- Back Link -->
		<div class="mb-8">
			<a href="/" class="inline-flex items-center text-sm font-medium text-gray-500 hover:text-primary transition-colors">
				<svg class="w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
				</svg>
				Back to Home
			</a>
		</div>

		<!-- Header -->
		<header class="text-center max-w-3xl mx-auto mb-12">
			<div class="inline-block px-3 py-1 rounded-full bg-primary/10 text-primary text-xs font-bold uppercase tracking-wider mb-4">
				{post.data.category}
			</div>
			<h1 class="text-4xl md:text-5xl font-bold text-gray-900 leading-tight mb-6">
				{post.data.title}
			</h1>
			<div class="flex items-center justify-center text-gray-500 text-sm">
				<time>{post.data.pubDate.toLocaleDateString('en-MY', { year: 'numeric', month: 'long', day: 'numeric' })}</time>
				<span class="mx-2">â€¢</span>
				<span>5 min read</span>
			</div>
		</header>

		<!-- Featured Image -->
		{post.data.image && (
			<div class="relative rounded-3xl overflow-hidden shadow-xl mb-12 aspect-video">
				<img 
					src={post.data.image} 
					alt={post.data.title} 
					class="w-full h-full object-cover"
				/>
			</div>
		)}

		<!-- Content -->
		<div class="prose prose-lg max-w-none prose-headings:font-bold prose-headings:text-gray-900 prose-p:text-gray-600 prose-a:text-primary prose-img:rounded-2xl">
			<Content />
		</div>
	</article>
</BlogLayout>

<style is:global>
	/* Custom Content Styling since we don't have @tailwindcss/typography installed yet */
	.prose p {
		margin-bottom: 1.5rem;
		line-height: 1.8;
		font-size: 1.125rem;
	}
	.prose h2 {
		font-size: 1.875rem;
		margin-top: 3rem;
		margin-bottom: 1.5rem;
		color: #111827;
		font-weight: 700;
	}
	.prose h3 {
		font-size: 1.5rem;
		margin-top: 2.5rem;
		margin-bottom: 1rem;
		color: #1f2937;
		font-weight: 600;
	}
	.prose ul, .prose ol {
		margin-bottom: 1.5rem;
		padding-left: 1.5rem;
		list-style-type: disc;
	}
	.prose li {
		margin-bottom: 0.5rem;
		color: #4b5563;
	}
	.prose blockquote {
		border-left-width: 4px;
		border-color: #ef4444; /* Primary Red */
		padding-left: 1rem;
		font-style: italic;
		color: #374151;
		margin-bottom: 1.5rem;
	}
	.prose img {
		max-width: 100%;
		height: auto;
		border-radius: 1rem;
		margin: 2rem 0;
	}
</style>
